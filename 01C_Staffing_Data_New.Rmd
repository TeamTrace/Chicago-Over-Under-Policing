---
title: "Format Chicago Police Staffing Data"
output:
  html_document:
    df_print: paged
    fig_caption: yes
    fig_height: 4
    fig_width: 9
    highlight: monochrom
    theme: cerulean
    toc: yes
    toc_float:
      collapsed: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	fig.align = "center",
	message = FALSE,
	warning = FALSE,
	width.cutoff = 10
)
```

<br>

This notebook formats Chicago Police Department staffing data obtained from the Invisible Institute's
[GitHub page](https://github.com/invinst/sworn-officer-import).

Officers assigned to the Mayor's Detail have been redacted
Please be advised that names and identifying information of Undercover Officers have been redacted

Yes, CPD_Sworn_Employees_Redacted is a more current production than P058155_-_Kiefer. They do include some historical information of sworn personnel who had resigned/retired/left the Department. A couple things to note, these other spreadsheets were processed by a different unit, the Research and Analysis Division, who no longer review, analyze, and process such data for FOIA requests. In addition, the historical data that was previously produced does not capture all 183+ years' worth of CPD personnel in all its history; it was simply the compilation of the sworn personnel information that we had in our existing databases at the time of production.
 
The data for your FOIA request was reviewed, analyzed, and processed by the Data Fulfillment and Analysis Section, which is a relatively new unit within the Information Services Division. To confirm, the data spreadsheet (with your name in it) contains current (at the time of the search) information from active sworn personnel whereas the others contain some personnel who are no longer with the Department, which is why some have resignation dates listed.
 
I hope that answered your questions. If not, please feel free to contact me.


```{r packages}

rm(list=ls())
gc()

# load default packages, functions, disable scientific notation
source("./Functions/default.R")

```


# Code table

```{r code table}

unit_codes <- read_excel("Input/CPD_staffing_data_FOIA/P058155_-_Kiefer.xlsx", guess_max = 4000000) %>%
  clean_names() %>%
  mutate(unit_code = str_pad(x_1, 3, pad = "0"),
         date_resigned_inferred = case_when(!is.na(resignation_date) ~ ymd(resignation_date),
                                       is.na(resignation_date)  ~ ymd("2017-04-01"),
                                       TRUE ~ ymd(NA))) %>%
  select(unit_code, unit_description, date_resigned_inferred) %>%
  unique() %>%
  filter(!is.na(unit_code)) %>%
  mutate(unit_description = case_when(
    # multiple similar names for three unit numbers
    unit_code == "057" ~ "TRAFFIC SECTION DETAIL UNIT",
    unit_code == "130" ~ "BUREAU OF STAFF SERVICES",
    unit_code == "603" ~ "BOMB AND ARSON DIVISION",
    
    # looked up in code table
    unit_code == "053" ~ "KENNEDY CONSTRUCTION",
    unit_code == "057" ~ "TRAFFIC SECTION DETAIL UNIT",
    unit_code == "058" ~ "SPECIAL FUNC CANINE",
    unit_code == "059" ~ "MARINE OPERATIONS UNIT",
    unit_code == "071" ~ "YOUTH DIVISION AREA 1",
    unit_code == "072" ~ "YOUTH DIVISION AREA 2",
    unit_code == "073" ~ "YOUTH DIVISION AREA 3",
    unit_code == "074" ~ "YOUTH DIVISION AREA 4",
    unit_code == "081" ~ "OEC-DIRECTOR OFFICE",
    unit_code == "091" ~ "NARC SPECIAL ENFORCE",
    unit_code == "092" ~ "NARC GENERAL ENFORCE",
    unit_code == "134" ~ "FIELD TECHNOLOGY TRAINING UNIT",
    unit_code == "138" ~ "FIELD MONITORING UNIT",
    unit_code == "215" ~ "DEPUTY CHIEF - AREA 5",
    unit_code == "216" ~ "DEPUTY CHIEF CENTRAL CONTROL GROUP",
    unit_code == "314" ~ "GANG SECTION - AREA 4",
    unit_code == "545" ~ "PBPA SERGEANT",
    unit_code == "549" ~ "INSPECTOR GENERAL DETAIL UNIT",
    unit_code == "660" ~ "UNKNOWN",
    unit_code == "661" ~ "PROP CRIMES DDA 5",
    
    #inferred based on sequntial unit numbers of Area 1, 2, 3, 5 and 6 PAT NARC PROG
    unit_code == "064" ~ "AREA 4 PAT NARC PROG",
    TRUE ~ unit_description)) %>%
  
  # some unit numbers have multiple, but similar, descriptions, so we are going to pull the most recent ones used so it doesn't become a row multiplier.
  arrange(unit_code, unit_description, date_resigned_inferred) %>%
  group_by(unit_code) %>%
  mutate(seq = row_number()) %>%
 # take only unit description with max seq number  
  group_by(unit_code) %>%
  mutate(max_seq = max(seq),
         take = ifelse(seq == max_seq, "Y", "N")) %>%
  ungroup() %>%
  filter(take == "Y") %>%
  
  select(unit_code, unit_description, unit_max_resign_date = date_resigned_inferred) %>%
  filter(!is.na(unit_code)) %>%
  unique() %>%
  
  # add manual unit categorizations
  left_join(
    (read_excel("Input/Manual_Categorizations/staff.xlsx") %>%
       mutate(unit_code = str_pad(unit_code, 3, pad = "0")) %>%
       select(unit_code, unit_group_inferred, unit_type_inferred) %>%
       unique())
    , by = "unit_code") %>%
  filter(!is.na(unit_code)) %>%
  unique() %>%
  mutate(unit_type_inferred = case_when(unit_code == "188" ~ "Organized Crime",
                                        unit_code == "192" ~ "Vice",
                                        unit_code %in% c("180", "184") ~ "Other",
                                        TRUE ~ unit_type_inferred),
         
         unit_group_inferred = case_when(unit_group_inferred == "Drug/ Gang/ Vice/ Asset Forfeiture" ~ unit_type_inferred, 
                                         unit_type_inferred == "Other" ~ "Other",
                                         TRUE ~ unit_group_inferred))

names(unit_codes)
make_report(unit_codes)
unit_codes %>% filter(is.na(unit_type_inferred))

unit_codes %>% write_csv("Output/sworn_off_unit_codes.csv")

```

# FOIA: Current staff assignment

- Current as of Oct. 1, 2019. Undercovers redacted.

```{r current}

emp_current <- read_csv("Input/CPD_staffing_data_FOIA/14426_P522438_Ryley_Current_Sworn_Info_fix.csv", guess_max = 3000000) %>%
  clean_names()

emp_current <- emp_current %>%
  mutate(
    # make row id because cpd did not provide unique identifier for employees, but this is supposed to be one row per employee
    emp_row_id = row_number(),
    unit_code = str_pad(cpd_unit, 3, pad = "0"),
    date_appointed = mdy(appointed_date1),
    date_start = mdy(unit_start_date1)) %>%

  # select records
  select(emp_row_id, 
         emp_first_name = first_nme,
         emp_middle_i = middle_initial,
         emp_last_name = last_nme,
         emp_gender = sex_code_cd, 
         emp_race = race, 
         emp_yob = dobyear,
         date_appointed, 
         date_start,
         unit_code,
         unit_description = cpd_unit_descr,
         emp_curr_title_code = employee_position_cd, 
         emp_curr_title = employee_position_descr) %>%
  
  # create uid, filter out what are likely duplicates, but it's only 8 employees
  group_by(emp_first_name, emp_last_name, date_appointed, emp_yob) %>%
  mutate(n = n()) %>%
  filter(n < 2) %>%
  select(-n) %>%
  mutate(emp_uid = paste(emp_first_name, emp_last_name, date_appointed, emp_yob, sep = "_")) %>%
  as.data.frame() %>%
  
  left_join((unit_codes %>%
               select(unit_code, unit_group_inferred, unit_type_inferred) %>%
               unique()), by = "unit_code") %>%
  unique() %>%
  select(sort(current_vars()))
# report with altered data
profile_missing(emp_current)


names(emp_current)
emp_current %>% 
  filter(is.na(unit_type_inferred)) %>% 
  group_by(unit_code, unit_description) %>% 
  summarise(n_emp = n_distinct(emp_row_id))

emp_current %>% 
  group_by(unit_group_inferred) %>%
  summarise(n = n_distinct(emp_row_id)) 
# Central Investigations	223			
# Detective Area	1058			
# Gang	239			
# Other	2062			
# Patrol	8062			
# Transit	212			
# NA	593	
emp_current %>% filter(unit_group_inferred == "Detective Area") %>%
  group_by(unit_code, unit_description) %>% summarise(n=n_distinct(emp_uid))
# 610	DETECTIVE AREA - CENTRAL	402		
# 620	DETECTIVE AREA - SOUTH	320		
# 630	DETECTIVE AREA - NORTH	336		

```

<br>

# FOIA: All current/former staff 

- As of July, 1, 2019
- source: mv_owner.cpd_employees, mv_owner.inv_cpd_star_nos, chris_dwh.race_codes, chris_dwh.employee_positions, chris_dwh.cpd_units
- The data is what is in electronic format at the time the report was generated.
- If the employee has resigned, the unit number is the last one on record in which the employee worked.

```{r sworn off}

sworn_off <- read_excel("Input/CPD_staffing_data_FOIA/CPD_Sworn_Employees_Redacted.xlsx", guess_max = 3000000) %>%
  clean_names()
# report with original data
make_report(sworn_off)

names(sworn_off)

sworn_off <- sworn_off %>%
  filter(!is.na(first_name)) %>%
  mutate(
    # make row id because cpd did not provide unique identifier for employees, but this is supposed to be one row per employee
    emp_row_id = row_number(),
    unit_code = str_pad(unit_number, 3, pad = "0"),
    date_appointed = ymd(appointment_date),
    date_resigned = ymd(resignation_date),
    # # make new "end date" for following quarter for officers who were current at time of output, 1-Jul-19 
    date_resigned_inferred = case_when(!is.na(resignation_date) ~ ymd(resignation_date),
                                       is.na(resignation_date)  ~ ymd("2019-10-01"),
                                       TRUE ~ ymd(NA))) %>%
  # select records
  select(emp_row_id,
         emp_first_name = first_name,
         emp_middle_i = mi,
         emp_last_name = last_name,
         emp_gender = sex, 
         emp_race = race, 
         emp_yob = dob_year, 
         date_appointed, 
         date_resigned,
         date_resigned_inferred,
         unit_code,
         unit_description = unit_name,
         emp_last_title_code = title_code, 
         emp_last_title = title,
         date_resigned) %>%
  
  # create uid, filter out what are likely duplicates, but it's only 8 employees
  group_by(emp_first_name, emp_last_name, date_appointed, emp_yob) %>%
  mutate(n = n()) %>%
  filter(n < 2) %>%
  select(-n) %>%
  mutate(emp_uid = paste(emp_first_name, emp_last_name, date_appointed, emp_yob, sep = "_")) %>%
  as.data.frame() %>%
  
  # join with unit codes
  left_join((unit_codes %>%
               select(unit_code, unit_group_inferred, unit_type_inferred) %>%
               unique()), by = "unit_code") %>%
  unique() %>%
  select(sort(current_vars()))

make_report(sworn_off)
head(sworn_off)
names(sworn_off)

# again, redacts drugs
sworn_off %>% group_by(unit_group_inferred) %>%
  summarise(n=n_distinct(emp_row_id)) 
# Central Investigations	641			
# Detective Area	2929			
# Gang	374			
# Organized Crime	76			
# Other	7289			
# Patrol	18066			
# Public Housing	100			
# Transit	636			
# Unknown	2			
# Vice	3			
# NA	3169	

```

<br>

# FOIA: Keifer Assignment 

Most recent date: 31-Mar-17

```{r old sworn_off}

sworn_off_old <- read_excel("Input/CPD_staffing_data_FOIA/P058155_-_Kiefer.xlsx", guess_max = 40000) %>%
  clean_names()

sworn_off_old <- sworn_off_old %>%
  mutate(unit_code = str_pad(x_1, 3, pad = "0"),
         date_appointed = ymd(appointed_date),
         # make new "end date" for officers who were current at time of output 31-Mar-17, which is the first day of the following quarter
         date_resigned_inferred = case_when(!is.na(resignation_date) ~ ymd(resignation_date),
                                      is.na(resignation_date) | status_i == "Y" ~ ymd("2017-04-01"),
                                      TRUE ~ ymd(NA)),
         date_resigned = ymd(resignation_date)) %>%

  # select records
  select(emp_first_name = first_name,
         emp_middle_i = middle_initital,
         emp_last_name = last_name,
         emp_gender = gender, 
         emp_race = race, 
         emp_yob = d_o_b,
         date_appointed, 
         unit_code,
         unit_description = unit_description,
         emp_status = status_i, 
         emp_last_title_code = employee_position_number, 
         emp_last_title = description,
         date_resigned,
         date_resigned_inferred) %>%
  
  # create uid, filter out what are likely duplicates, but it's only 8 employees
  group_by(emp_first_name, emp_last_name, date_appointed, emp_yob) %>%
  mutate(n = n()) %>%
  filter(n < 2) %>%
  select(-n) %>%
  mutate(emp_uid = paste(emp_first_name, emp_last_name, date_appointed, emp_yob, sep = "_")) %>%
  as.data.frame() %>%
  
  # join with unit codes
  left_join((unit_codes %>%
               select(unit_code, unit_group_inferred, unit_type_inferred) %>%
               unique()), by = "unit_code") %>%
  unique() %>%
  select(sort(current_vars()))

sworn_off_old %>% group_by(unit_group_inferred) %>%
  summarise(n=n_distinct(emp_uid))

# Central Investigations	426			
# Detective Area	2637			
# Drug	419			
# Gang	550			
# Organized Crime	75			
# Other	6658			
# Patrol	19120			
# Public Housing	120			
# Transit	589			
# Unknown	64	
# Vice	180			
# NA	1373	

sworn_off_old %>% filter(is.na(unit_group_inferred)) %>%
  group_by(unit_code, unit_description) %>%
  summarise(n=n_distinct(emp_uid)) %>%
  arrange(-n)

sworn_off_old %>% filter(is.na(unit_group_inferred) & is.na(unit_description))

```

## Compare old and new 

in_old, in_new, n
- Y	Y	30013		In both
- Y	NA	1673		Missing in new data (likely undercovers)
- NA	Y	3249	Missing in old data (likely new hires)

```{r compare sworn off}


# not many detective area employees missing, but a lot of drug and gang
missing <- sworn_off_old %>%
  mutate(in_old = "Y") %>%
  select(emp_uid, 
         emp_last_title_old = emp_last_title,
         unit_description_old = unit_description,
         unit_group_inferred_old = unit_group_inferred,
         date_appointed_old = date_appointed,
         date_resigned_old = date_resigned_inferred,
         in_old) %>%
  full_join((sworn_off %>%
               select(emp_uid, 
                      emp_last_title_new = emp_last_title,
                      unit_description_new = unit_description,
                      unit_group_inferred_new = unit_group_inferred,
                      date_appointed_new = date_appointed,
                      date_resigned_new = date_resigned_inferred) %>%
               mutate(in_new = "Y")), by = c("emp_uid")) %>%
  mutate(missing = ifelse(is.na(in_new) | is.na(in_old), TRUE, FALSE))

missing %>% group_by(in_old, in_new) %>%
  summarise(n = n_distinct(emp_uid))

missing %>%
  filter(!is.na(in_old)) %>%
  group_by(unit_group_inferred_old, in_old, missing) %>%
  summarise(n=n_distinct(emp_uid)) %>%
  spread(missing, n) %>%
  adorn_pct_down()

missing %>% filter(is.na(in_new) & unit_group_inferred_old == "Drug")

missing %>%
  filter(!is.na(in_new)) %>%
  group_by(unit_group_inferred_old, in_new, missing) %>%
  summarise(n=n_distinct(emp_uid)) %>%
  spread(missing, n) %>%
  adorn_pct_down()

```

<br>

# FOIA: Asignment history

- One row per assignment
- Employees whose status changed from sworn to civilian cannot be retrieved electronically.
- Source: ClearDW; CPD_EMPLOYEES_MV, RACE_CODES, PPS_EMP_ASSIGNED_HISTORY_MV; Query on 12 October 2016.

```{r sworn asgn}

sworn_asgn <- read_csv("Input/CPD_staffing_data_FOIA/FOIA_P052262_-_11221-FOIA-P052262-AllSwornEmployeesWithUOA.csv", guess_max = 2000000) %>%
  clean_names() 

# 115987 records, report of original data
make_report(sworn_asgn)
names(sworn_asgn)

sworn_asgn <- sworn_asgn %>%
  mutate(unit_code = str_pad(assigned_unit_num, 3, pad = "0"),
         date_appointed = ymd(date_of_appointment),
         date_start = ymd(start_date),
         date_end = ymd(end_date),
         row_id = row_number(),
         
         # this is just a dummy field for joining with quarters
         link = "a") %>%
  select(row_id,
         emp_first_name = first_name,
         emp_middle_i = middle_initial,
         emp_last_name = last_name,
         emp_gender = gender, 
         emp_race = race,
         emp_yob = year_of_birth,
         date_appointed,
         date_start,
         date_end,
         unit_code) %>%
  mutate(emp_uid = paste(emp_first_name, emp_last_name, date_appointed, emp_yob, sep = "_")) %>%
  # add definitions of units
  left_join(unit_codes, by = "unit_code") %>%
  unique() %>%
  select(sort(current_vars()))


make_report(sworn_asgn)

```

# IA: Assignment history

```{r sworn asgn old, eval=FALSE, include=FALSE}

sworn_asgn_old <- read_excel("Input/Invisible_Institute/CPD Employees, one row per unit assignment per officer.xlsx", guess_max = 2000000) %>%
  clean_names() 
# 114630 records, report of original data
names(sworn_asgn_old)

sworn_asgn_old <- sworn_asgn_old %>%
 mutate(unit_code = str_pad(cpd_unit_assigned_no, 3, pad = "0"),
         date_appointed = ymd(appointed_date),
         date_start = ymd(effective_date),
         date_end = ymd(end_date),
         row_id = row_number(),
         
         # this is just a dummy field for joining with quarters
         link = "a") %>%
  select(row_id,
         emp_first_name = first_nme,
         emp_last_name = last_nme,
         emp_gender = sex_code_cd, 
         emp_race = race,
         emp_age = currage,
         date_appointed,
         date_start,
         date_end,
         unit_code) %>%
  mutate(emp_uid = paste(emp_first_name, emp_last_name, date_appointed, emp_age, sep = "_")) %>%
  # add definitions of units
  left_join(unit_codes, by = "unit_code") %>%
  unique() %>%
  select(sort(current_vars()))

```

## Compare FOIA and IA

Our FOIA data has 1,414 records that the Invisible Institute didn't have

```{r compare sworn asgn, eval=FALSE, include=FALSE}

sworn_asgn_old %>%
  anti_join(sworn_asgn, by = c("emp_first_name", "emp_last_name", "date_appointed", "date_start", "unit_code")) %>%
  group_by(unit_group_inferred) %>%
  summarise(n = n_distinct(emp_uid)) %>%
  adorn_totals()
 # unit_group_inferred  n
 #      Detective Area  3
 #                Drug  2
 #               Total 66

sworn_asgn %>%
  anti_join(sworn_asgn_old, by = c("emp_first_name", "emp_last_name", "date_appointed", "date_start", "unit_code")) %>%
  group_by(unit_group_inferred) %>%
  summarise(n = n_distinct(emp_uid)) %>%
  adorn_totals()
 #    unit_group_inferred    n
 # Central Investigations   13
 #         Detective Area   10
 #                   Drug   33
 #                   Gang   19
 #                  Total 1414
sworn_asgn %>%
  anti_join(sworn_asgn_old, by = c("emp_first_name", "emp_last_name", "date_appointed", "date_start", "unit_code")) %>%
  group_by(year(date_appointed)) %>%
  summarise(n = n_distinct(emp_uid)) %>%
  adorn_totals()
                #  2014  156
                #  2015  188
                #  2016  416
                # Total 1381

sworn_asgn %>% write_csv("temp.csv")
sworn_asgn %>%
  group_by(unit_code, unit_description, unit_group_inferred, unit_type_inferred) %>%
  summarise(n=n()) %>%
  write_csv("temp.csv")

match <- sworn_asgn_old %>%
  full_join(
    (sworn_asgn %>%
       select(emp_first_name,
              emp_last_name,
              date_appointed,
              unit_code,
              date_end_new = date_end) %>%
       mutate(in_new = "Y")), 
    by = c("emp_first_name", "emp_last_name", "date_appointed", 
           "date_start", "unit_code")) %>%
  mutate(match_end = year(date_end) == year(date_end_new))

match %>%
  filter(!match) %>%
  group_by(unit_group_inferred) %>%
  summarise(n = n_distinct(emp_uid)) %>%
  adorn_totals()
 #    unit_group_inferred    n
 # Central Investigations   12
 #         Detective Area  121
 #                   Drug   13
 #                   Gang    3
 #        Organized Crime    1
 #                  Other  131
 #                 Patrol 2026
 #                Transit    4
 #                   <NA>   25
 #                  Total 2336

match %>%
  filter(!match & 
           unit_group_inferred == "Detective Area") %>%
  group_by(year(date_end_new)) %>%
  summarise(n = n_distinct(emp_uid)) %>%
  adorn_totals()


  

```

## Join asignment history

```{r join}

sworn_join <- sworn_asgn %>%
  full_join(
    (emp_current %>%
       select(emp_uid,
              date_start,
              unit_code,
              emp_curr_title)),
    by = c("emp_uid", "date_start", "unit_code")) %>%
  mutate(asgn_current = case_when(!is.na(emp_curr_title) ~ TRUE,
                                     TRUE ~ FALSE)) %>%
  # pulling resigned dates from other data because they aren't always in the assignment history data
  full_join(
    (sworn_off %>%
       select(emp_uid, 
              sworn_off_date_resigned = date_resigned)),
    by = "emp_uid") %>%
  
  full_join(
    (sworn_off_old %>%
       select(emp_uid, 
              sworn_off_old_date_resigned = date_resigned,
              date_resigned_inferred)),
    by = "emp_uid") %>%  
  mutate(date_end_inferred = case_when(
    !is.na(date_end) ~ ymd(date_end),
    asgn_current ~ ymd("2020-01-01"),
    !is.na(sworn_off_date_resigned) ~ ymd(sworn_off_date_resigned),
    !is.na(sworn_off_old_date_resigned) ~ ymd(sworn_off_old_date_resigned),
    !is.na(date_resigned_inferred) ~ ymd(date_resigned_inferred),
    TRUE ~ ymd("2017-01-01")),
    link = "a") %>%
  select(sort(current_vars()))

sworn_join %>%
  filter(is.na(date_end_inferred)) %>%
  group_by(unit_group_inferred, unit_description) %>%
  summarise(n=n())

```

<br>

### Join with quarters

```{r quarter}

### a file with every quarter since 1980 that I created manually because I was having trouble getting the time-period analysis to work
quarter <- sworn_join %>%
  filter(year(date_end_inferred) >= 1980) %>%
  left_join(
    (read_excel("Input/Manual_Categorizations/month_year.xlsx") %>%
       mutate(link = "a",
              quarter = ymd(quarter)))
    , by = "link") %>%
  filter(date_start <= quarter & date_end_inferred >= quarter) %>%
  select(-c(link))

make_report(quarter)
names(sworn_join)
```

```{r staff}
staff <- quarter %>%
  group_by(unit_code,
           unit_description,
           unit_type_inferred,
           unit_group_inferred,
           quarter) %>%
  summarise(n_emp_quarter = n_distinct(emp_uid)) %>%
  
  # make quarter average for year to account for people who were only on for a short period
  group_by(unit_code,
           unit_description,
           unit_type_inferred,
           unit_group_inferred,
           year = year(quarter)) %>%
  mutate(n_emp_year = round((mean(n_emp_quarter)),0)) %>%
  select(unit_code, unit_description, unit_type_inferred, unit_group_inferred, year, n_emp_year) %>%
  unique() %>%
  as.data.frame()

```

```{r staff counts check}


staff %>%
  filter(unit_group_inferred == "Detective Area") %>%
  group_by(year) %>%
  summarise(n = sum(n_emp_year))

staff %>%
  filter(year >= 2000 & year <= 2016,
           unit_group_inferred %in% c("Detective Area", "Drug", "Gang")) %>%
  group_by(year, unit_group_inferred) %>%
  summarise(n = sum(n_emp_year)) %>%
  spread(unit_group_inferred, n)

staff %>%
  filter(year >= 2000 & year <= 2016,
           unit_group_inferred %in% c("Detective Area", "Drug", "Gang")) %>%
  group_by(year, unit_group_inferred) %>%
  summarise(n = sum(n_emp_year)) %>%
  spread(unit_group_inferred, n) %>%
  write_csv("Output/annual_staff_foia.csv")

emp_current %>%
  group_by(unit_group_inferred) %>%
  summarise(n=n_distinct(emp_uid))


```

<br>

## Write csvs

```{r write csvs}

sworn_asgn %>% write_csv("Output/staff_join_foia.csv")

quarter %>% write_csv("Output/staff_quarter_foia.csv") 

emp_current %>% write_csv("Output/staff_current_foia.csv") 

```


